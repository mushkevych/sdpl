# File generated by SDPL compiler from tests/snippet_15.sdpl
# Do not edit the file manually
# # snippet: testing GROUP BY and ORDER BY construct
# # load A
A = sqlContext.read.csv('s3://my_bucket.s3.amazonaws.com:443/path/within/bucket/table_name', schema=StructType([
    StructField('name', StringType, False),
    StructField('alpha', IntegerType, True),
    StructField('beta', StringType, True) ])
    , sep=',')
# # load B
B = sqlContext.read.csv('s3://my_bucket.s3.amazonaws.com:443/path/within/bucket/file_blob', schema=StructType([
    StructField('query', StringType, False),
    StructField('page_number', IntegerType, False),
    StructField('result_per_page', IntegerType, False),
    StructField('corpus', StringType, False) ])
    , sep=',')
# # ORDER BY clause
C = A.orderBy(A.alpha, A.beta)
# # ORDER BY clause
D = B.groupBy(B.query, B.page_number)
# # user formatted comments ahead of STORE C
sqlContext.write.csv('s3://my_bucket.s3.amazonaws.com:443/path/within/bucket/table_name', compression='SNAPPY', sep=',')
# # user formatted comments ahead of STORE D
sqlContext.write.csv('s3://my_bucket.s3.amazonaws.com:443/path/within/bucket/table_name', compression='SNAPPY', sep=',')
# SDPL output: EOF
